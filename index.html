<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Got Water? – Georgia Power Energy & Water Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <style>
    :root {
      --bg: #050816;
      --panel: #0b1220;
      --panel-soft: #111827;
      --accent: #38bdf8;
      --accent-soft: #1f2937;
      --text-main: #e5e7eb;
      --text-muted: #9ca3af;
      --border-subtle: #1f2937;
      --radius-xl: 18px;
      --radius-lg: 14px;
      --shadow-soft: 0 18px 40px rgba(15, 23, 42, 0.75);
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      min-height: 100vh;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text",
        "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #111827 0, #020617 55%, #000 100%);
      color: var(--text-main);
    }

    main {
      max-width: 1200px;
      margin: 0 auto;
      padding: 32px 20px 60px;
    }

    .hero {
      padding: 24px 24px 22px;
      border-radius: var(--radius-xl);
      background: radial-gradient(circle at top left, rgba(56, 189, 248, 0.12), transparent 55%),
                  radial-gradient(circle at bottom right, rgba(52, 211, 153, 0.08), transparent 55%),
                  #020617;
      border: 1px solid rgba(148, 163, 184, 0.25);
      box-shadow: var(--shadow-soft);
      margin-bottom: 26px;
    }

    .hero h1 {
      margin: 0 0 6px;
      font-size: 26px;
      letter-spacing: 0.02em;
    }

    .hero .subtitle {
      margin: 0 0 6px;
      color: var(--text-muted);
      font-size: 14px;
    }

    .hero .meta {
      margin: 0;
      font-size: 13px;
      color: #cbd5f5;
    }

    .hero .meta span {
      color: var(--accent);
    }

    .pill-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 14px;
      font-size: 12px;
    }

    .pill {
      padding: 4px 10px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(148, 163, 184, 0.35);
      color: var(--text-muted);
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .pill-dot {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: var(--accent);
    }

    h2.section-title {
      margin: 26px 2px 14px;
      font-size: 18px;
      font-weight: 600;
      letter-spacing: 0.02em;
    }

    .section-caption {
      margin: 0 2px 18px;
      font-size: 13px;
      color: var(--text-muted);
    }

    .grid-2 {
      display: grid;
      grid-template-columns: minmax(0, 1.1fr) minmax(0, 1fr);
      gap: 18px;
      align-items: stretch;
    }

    @media (max-width: 900px) {
      .grid-2 {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .card {
      background: radial-gradient(circle at top left, rgba(56, 189, 248, 0.11), transparent 55%),
                  radial-gradient(circle at bottom right, rgba(14, 165, 233, 0.15), transparent 60%),
                  var(--panel);
      border-radius: var(--radius-xl);
      padding: 16px 18px 16px;
      border: 1px solid rgba(148, 163, 184, 0.28);
      box-shadow: var(--shadow-soft);
      position: relative;
      overflow: hidden;
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      margin-bottom: 10px;
      gap: 8px;
    }

    .card-title {
      font-size: 14px;
      font-weight: 600;
    }

    .card-subtitle {
      font-size: 11px;
      color: var(--text-muted);
    }

    .card-footnote {
      margin-top: 8px;
      font-size: 11px;
      color: var(--text-muted);
    }

    canvas {
      max-width: 100%;
    }

    .image-strip {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 16px;
    }

    .image-card {
      background: var(--panel-soft);
      border-radius: var(--radius-lg);
      padding: 10px 10px 12px;
      border: 1px solid rgba(31, 41, 55, 0.9);
      box-shadow: 0 14px 32px rgba(15, 23, 42, 0.85);
    }

    .image-card img {
      display: block;
      width: 100%;
      border-radius: 12px;
      border: 1px solid rgba(30, 64, 175, 0.9);
    }

    .image-caption {
      margin-top: 6px;
      font-size: 12px;
      color: var(--text-muted);
    }

    /* Policy heatmap */
    .policy-wrap {
      margin-top: 6px;
      display: grid;
      grid-template-columns: minmax(0, 1.3fr) minmax(0, 1fr);
      gap: 14px;
    }

    @media (max-width: 900px) {
      .policy-wrap {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .heatmap-container {
      overflow-x: auto;
    }

    table.heatmap {
      border-collapse: collapse;
      width: 100%;
      min-width: 520px;
      font-size: 12px;
    }

    .heatmap th,
    .heatmap td {
      padding: 8px 10px;
      border: 1px solid rgba(31, 41, 55, 0.8);
      text-align: center;
      white-space: nowrap;
    }

    .heatmap th {
      background: rgba(15, 23, 42, 0.95);
      color: #e5e7eb;
      font-weight: 600;
    }

    .heatmap td.policy-label {
      text-align: left;
      font-weight: 500;
      color: #e5e7eb;
      background: #020617;
    }

    .heatmap-legend {
      margin-top: 10px;
      font-size: 11px;
      color: var(--text-muted);
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .legend-bar {
      flex: 0 0 120px;
      height: 10px;
      border-radius: 999px;
      background: linear-gradient(90deg, #b91c1c, #eab308, #22c55e);
      border: 1px solid rgba(31, 41, 55, 0.9);
    }

    .legend-labels {
      display: flex;
      justify-content: space-between;
      flex: 0 0 120px;
    }

    .legend-labels span {
      font-size: 10px;
    }

    .policy-text {
      font-size: 12px;
      color: var(--text-muted);
      line-height: 1.5;
    }

    /* Map */
    .map-card iframe {
      width: 100%;
      height: 360px;
      border: none;
      border-radius: 14px;
      background: #020617;
    }

    .small-note {
      font-size: 11px;
      color: var(--text-muted);
      margin-top: 4px;
    }

    /* Footer */
    footer {
      margin-top: 30px;
      font-size: 11px;
      color: var(--text-muted);
      text-align: right;
    }
  </style>
</head>
<body>
  <main>
    <!-- HERO / TITLE -->
    <header class="hero">
      <h1>Got Water? Identifying Water Constraints amid Growing Energy Demand in Georgia</h1>
      <p class="subtitle">Georgia Power 2025 IRP · Energy &amp; Water Scenario Dashboard</p>
      <p class="meta">
        Authors: <span>Chloe Glover</span>, Natalie, and Clarissa &nbsp;·&nbsp;
        Project Partner: <span>Cherry Street Energy</span> &nbsp;·&nbsp;
        Course: SUST 4500
      </p>
      <div class="pill-row">
        <div class="pill"><span class="pill-dot"></span> Status Quo</div>
        <div class="pill"><span class="pill-dot"></span> IRP Expansion</div>
        <div class="pill"><span class="pill-dot"></span> Renewable Priority</div>
        <div class="pill">Horizon: 2025–2036</div>
      </div>
    </header>

    <!-- STATIC PNG OVERVIEW (3 IMAGES) -->
    <h2 class="section-title">Dashboard Snapshots</h2>
    <p class="section-caption">
      These static exports from our Excel &amp; Power BI models show the baseline data, capacity mix,
      and water consumption by fuel used to drive the interactive visuals below.
    </p>
    <section class="image-strip">
      <article class="image-card">
        <img src="data.png" alt="Georgia Power generation mix data table and charts" />
        <div class="image-caption">Source data summary for Georgia Power capacity, demand, and water use.</div>
      </article>
      <article class="image-card">
        <img src="power.png" alt="Capacity by energy type chart" />
        <div class="image-caption">Capacity by energy type (MW) across scenarios.</div>
      </article>
      <article class="image-card">
        <img src="water.png" alt="Water consumption by energy type chart" />
        <div class="image-caption">Annual water withdrawals and consumption by energy type.</div>
      </article>
    </section>

    <!-- TIME-SERIES CAPACITY & WATER -->
    <h2 class="section-title">Status Quo Trajectories: Energy Capacity &amp; Water Use</h2>
    <p class="section-caption">
      Line charts below track capacity and water withdrawals by fuel under the Status Quo portfolio
      from 2025–2036. All water values are taken directly from the <strong>Water</strong> table you provided;
      capacity values come from the <strong>ENERGY</strong> table.
    </p>

    <section class="grid-2">
      <!-- Capacity by fuel -->
      <article class="card">
        <div class="card-header">
          <div>
            <div class="card-title">Status Quo – Capacity by Energy Type (MW)</div>
            <div class="card-subtitle">Each line is one fuel; legend key shows capacity by fuel.</div>
          </div>
        </div>
        <canvas id="capacityByFuel"></canvas>
        <p class="card-footnote">
          Data: ENERGY &rarr; Scenario = Status Quo, years 2025–2036.
        </p>
      </article>

      <!-- Water by fuel -->
      <article class="card">
        <div class="card-header">
          <div>
            <div class="card-title">Status Quo – Water Consumption by Energy Type (Million Gallons)</div>
            <div class="card-subtitle">
              Corrected legend: one series per fuel (Nuclear, Natural Gas, Coal, Hydro, Solar, Other).
            </div>
          </div>
        </div>
        <canvas id="waterByFuel"></canvas>
        <p class="card-footnote">
          Data: Water &rarr; Scenario = Status Quo, years 2025–2036.
        </p>
      </article>
    </section>

    <!-- 2036 MIX + MONTE CARLO -->
    <h2 class="section-title">2036 Portfolio &amp; Uncertainty</h2>
    <p class="section-caption">
      Comparing the 2036 end-state portfolios across scenarios and showing how Monte Carlo uncertainty
      widens the range of possible capacity outcomes.
    </p>

    <section class="grid-2">
      <!-- 2036 mix by scenario -->
      <article class="card">
        <div class="card-header">
          <div>
            <div class="card-title">2036 Capacity Mix by Scenario</div>
            <div class="card-subtitle">
              Fuel-specific capacity for Status Quo, IRP Expansion, and Renewable Priority.
            </div>
          </div>
        </div>
        <canvas id="mix2036"></canvas>
        <p class="card-footnote">
          Uses 2036 rows from the ENERGY sheet for each scenario. This replaces the previous donut chart
          with an easier-to-read grouped bar chart.
        </p>
      </article>

      <!-- Monte Carlo -->
      <article class="card">
        <div class="card-header">
          <div>
            <div class="card-title">Monte Carlo Range – Total Capacity (Status Quo)</div>
            <div class="card-subtitle">
              Base IRP trajectory with ±10% and ±5% envelopes to illustrate scenario uncertainty.
            </div>
          </div>
        </div>
        <canvas id="monteCarlo"></canvas>
        <p class="card-footnote">
          Base line is the Status Quo total capacity from ENERGY (2025–2036). The outer band (10%) and inner band (5%)
          approximate the Monte Carlo range from our Excel model.
        </p>
      </article>
    </section>

    <!-- POLICY HEATMAP -->
    <h2 class="section-title">Policy &amp; Scenario Implications</h2>
    <p class="section-caption">
      Each policy lever is scored from 1 (low) to 5 (high) across four criteria: reliability, water-stress
      reduction, cost, and feasibility. Colors run from red (poor outcome) to green (strong outcome).
    </p>

    <section class="card">
      <div class="card-header">
        <div>
          <div class="card-title">Policy Options: Reliability, Water Stress ↓, Cost, Feasibility (1–5)</div>
          <div class="card-subtitle">
            Scores summarize how each lever performs when layered onto the IRP trajectories.
          </div>
        </div>
      </div>
      <div class="policy-wrap">
        <div class="heatmap-container">
          <table class="heatmap">
            <thead>
              <tr>
                <th>Policy Option</th>
                <th>Reliability</th>
                <th>Water Stress ↓</th>
                <th>Cost</th>
                <th>Feasibility</th>
              </tr>
            </thead>
            <tbody>
              <!-- Scores: 1 = low, 5 = high -->
              <tr>
                <td class="policy-label">Demand-Side Management</td>
                <td data-score="3">3</td>
                <td data-score="3">3</td>
                <td data-score="4">4</td>
                <td data-score="5">5</td>
              </tr>
              <tr>
                <td class="policy-label">Gas Expansion</td>
                <td data-score="5">5</td>
                <td data-score="1">1</td>
                <td data-score="3">3</td>
                <td data-score="3">3</td>
              </tr>
              <tr>
                <td class="policy-label">Renewable Expansion</td>
                <td data-score="4">4</td>
                <td data-score="4">4</td>
                <td data-score="3">3</td>
                <td data-score="4">4</td>
              </tr>
              <tr>
                <td class="policy-label">Closed-loop Cooling</td>
                <td data-score="4">4</td>
                <td data-score="5">5</td>
                <td data-score="2">2</td>
                <td data-score="3">3</td>
              </tr>
            </tbody>
          </table>
          <div class="heatmap-legend">
            <div class="legend-bar"></div>
            <div class="legend-labels">
              <span>1</span>
              <span>3</span>
              <span>5</span>
            </div>
            <span>Policy scoring across reliability, water reduction, cost, and feasibility (1–5 scale).</span>
          </div>
        </div>
        <div class="policy-text">
          <p><strong>6.3 Policy–Impact Matrix.</strong><br />
            To evaluate relative outcomes, each policy action was scored from 1 (low) to 5 (high) across four
            criteria: energy reliability, water stress reduction, economic cost, and implementation feasibility.
          </p>
          <p><strong>6.4 Interpretation.</strong><br />
            Sensitivity results demonstrate that <strong>renewable expansion</strong> and
            <strong>closed-loop cooling</strong> deliver the most significant co-benefits across both energy
            reliability and water conservation. In contrast, aggressive gas expansion increases reliability but
            also raises water stress, while demand-side management remains the most cost-effective strategy with
            broad feasibility. These findings affirm the need for adaptive, multi-sector governance as Georgia
            experiences rapid AI-driven industrial growth. Embedding water-budgeting standards and renewable
            incentives can enhance long-term sustainability.
          </p>
        </div>
      </div>
    </section>

    <!-- GIS / MAP SECTION -->
    <h2 class="section-title">Spatial View: Georgia Power &amp; Water Stress</h2>
    <p class="section-caption">
      Interactive GIS view of plant locations, cooling technologies, and watershed context. This section is where
      your ArcGIS map is embedded.
    </p>

    <section class="card map-card">
      <iframe
        src="YOUR_ARCGIS_EMBED_URL_HERE"
        title="Georgia Energy &amp; Water GIS"
        loading="lazy"
        allowfullscreen>
      </iframe>
      <p class="small-note">
        Replace <code>YOUR_ARCGIS_EMBED_URL_HERE</code> in the HTML with the actual ArcGIS iframe URL from your map
        or StoryMap to activate this embed.
      </p>
    </section>

    <footer>
      Georgia Power 2025 IRP · Energy–Water Nexus · SUST 4500
    </footer>
  </main>

  <script>
    // Shared labels
    const years = [2025, 2026, 2027, 2028, 2029, 2030, 2031, 2032, 2033, 2034, 2035, 2036];

    // ENERGY – Status Quo (from ENERGY sheet)
    const energyStatusQuo = {
      nuclear: [2563.94472, 2541.14472, 2465.78472, 2712.02472, 3037.70472, 3364.34472, 3449.42472, 3497.78472, 3557.30472, 3598.82472, 3894.86472, 3930.98472],
      gas:     [9401.13064, 9317.53064, 9041.21064, 9944.09064, 11138.25064, 12335.93064, 12647.89064, 12825.21064, 13043.45064, 13195.69064, 14281.17064, 14413.61064],
      coal:    [3418.59296, 3388.19296, 3287.71296, 3616.03296, 4050.27296, 4485.79296, 4599.23296, 4663.71296, 4743.07296, 4798.43296, 5193.15296, 5241.31296],
      hydro:   [1068.3103, 1058.8103, 1027.4103, 1130.0103, 1265.7103, 1401.8103, 1437.2603, 1457.4103, 1482.2103, 1499.5103, 1622.8603, 1637.9103],
      solar:   [2991.26884, 2964.66884, 2876.74884, 3164.02884, 3543.98884, 3925.06884, 4024.32884, 4080.74884, 4150.18884, 4198.62884, 4544.00884, 4586.14884],
      other:   [1922.95854, 1905.85854, 1849.33854, 2034.01854, 2278.27854, 2523.25854, 2587.06854, 2623.33854, 2667.97854, 2699.11854, 2921.14854, 2948.23854],
      total:   [21366.206, 21176.206, 20548.206, 22600.206, 25314.206, 28036.206, 28745.206, 29148.206, 29644.206, 29990.206, 32457.206, 32758.206]
    };

    // WATER – Status Quo (from Water sheet)
    const waterStatusQuo = {
      nuclear: [14172.538, 14046.508, 13629.9458, 14991.0694, 16791.308, 18596.8531, 19067.1438, 19334.46, 19663.4646, 19892.9718, 21529.3714, 21729.0294],
      gas:     [6391.98064, 6335.13965, 6147.26522, 6761.14792, 7573.0766, 8387.39859, 8599.50524, 8720.06797, 8868.45287, 8971.96331, 9709.9987, 9800.0468],
      coal:    [1131.55427, 1121.49187, 1088.23299, 1196.90691, 1340.64035, 1484.79747, 1522.34611, 1543.68899, 1569.95715, 1588.28131, 1718.93363, 1734.87459],
      hydro:   [38.6033927, 38.2601102, 37.1254712, 40.8329222, 45.7364417, 50.6544152, 51.9354009, 52.6635212, 53.5596692, 54.1848047, 58.6420569, 59.1858887],
      solar:   [149.360036, 148.031845, 143.641823, 157.986288, 176.958451, 195.986537, 200.942788, 203.759951, 207.227229, 209.645935, 226.891449, 228.995584],
      other:   [120.004612, 118.937466, 115.410265, 126.935449, 142.178797, 157.467078, 161.44922, 163.712695, 166.498509, 168.441839, 182.297897, 183.988482]
    };

    // 2036 capacity by scenario & fuel (ENERGY table)
    const fuels = ["Nuclear", "Natural Gas", "Coal", "Hydro", "Solar", "Other"];
    const scenarioLabels = ["Status Quo", "IRP Expansion", "Renewable Priority"];

    const capacity2036ByScenario = {
      "Status Quo":       [3930.98472, 14413.61064, 5241.31296, 1637.9103, 4586.14884, 2948.23854],
      "IRP Expansion":    [5896.47708, 15396.35682, 3275.8206, 2293.07442, 5241.31296, 655.16412],
      "Renewable Priority": [8189.5515, 11465.3721, 655.16412, 3930.98472, 7534.38738, 982.74618]
    };

    // ----- CAPACITY BY FUEL (Status Quo) -----
    const capacityCtx = document.getElementById("capacityByFuel");
    if (capacityCtx) {
      new Chart(capacityCtx, {
        type: "line",
        data: {
          labels: years,
          datasets: [
            { label: "Nuclear Capacity", data: energyStatusQuo.nuclear, tension: 0.25 },
            { label: "Natural Gas Capacity", data: energyStatusQuo.gas, tension: 0.25 },
            { label: "Coal Capacity", data: energyStatusQuo.coal, tension: 0.25 },
            { label: "Hydro Capacity", data: energyStatusQuo.hydro, tension: 0.25 },
            { label: "Solar Capacity", data: energyStatusQuo.solar, tension: 0.25 },
            { label: "Other Capacity", data: energyStatusQuo.other, tension: 0.25 }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          interaction: { mode: "index", intersect: false },
          plugins: {
            legend: {
              labels: { boxWidth: 14, boxHeight: 14 }
            },
            tooltip: {
              callbacks: {
                label: ctx => `${ctx.dataset.label}: ${ctx.parsed.y.toLocaleString(undefined, { maximumFractionDigits: 0 })} MW`
              }
            }
          },
          scales: {
            x: {
              grid: { color: "rgba(31,41,55,0.6)" }
            },
            y: {
              title: { display: true, text: "Capacity (MW)" },
              grid: { color: "rgba(31,41,55,0.6)" }
            }
          }
        }
      });
    }

    // ----- WATER BY FUEL (Status Quo) -----
    const waterCtx = document.getElementById("waterByFuel");
    if (waterCtx) {
      new Chart(waterCtx, {
        type: "line",
        data: {
          labels: years,
          datasets: [
            { label: "Nuclear", data: waterStatusQuo.nuclear, tension: 0.25 },
            { label: "Natural Gas", data: waterStatusQuo.gas, tension: 0.25 },
            { label: "Coal", data: waterStatusQuo.coal, tension: 0.25 },
            { label: "Hydro", data: waterStatusQuo.hydro, tension: 0.25 },
            { label: "Solar", data: waterStatusQuo.solar, tension: 0.25 },
            { label: "Other", data: waterStatusQuo.other, tension: 0.25 }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          interaction: { mode: "index", intersect: false },
          plugins: {
            legend: {
              labels: { boxWidth: 14, boxHeight: 14 }
            },
            tooltip: {
              callbacks: {
                label: ctx => `${ctx.dataset.label}: ${ctx.parsed.y.toLocaleString(undefined, { maximumFractionDigits: 0 })} Mgal`
              }
            }
          },
          scales: {
            x: {
              grid: { color: "rgba(31,41,55,0.6)" }
            },
            y: {
              title: { display: true, text: "Water Consumption (Million Gallons)" },
              grid: { color: "rgba(31,41,55,0.6)" }
            }
          }
        }
      });
    }

    // ----- 2036 MIX BY SCENARIO -----
    const mixCtx = document.getElementById("mix2036");
    if (mixCtx) {
      new Chart(mixCtx, {
        type: "bar",
        data: {
          labels: fuels,
          datasets: scenarioLabels.map((scenario, idx) => ({
            label: scenario,
            data: capacity2036ByScenario[scenario],
            borderWidth: 1
          }))
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          interaction: { mode: "index", intersect: false },
          plugins: {
            legend: {
              labels: { boxWidth: 14, boxHeight: 14 }
            },
            tooltip: {
              callbacks: {
                label: ctx =>
                  `${ctx.dataset.label}: ${ctx.parsed.y.toLocaleString(undefined, { maximumFractionDigits: 0 })} MW`
              }
            }
          },
          scales: {
            x: {
              grid: { color: "rgba(31,41,55,0.6)" }
            },
            y: {
              title: { display: true, text: "Capacity in 2036 (MW)" },
              grid: { color: "rgba(31,41,55,0.6)" },
              beginAtZero: true
            }
          }
        }
      });
    }

    // ----- MONTE CARLO FAN (approximate) -----
    const baseTotals = energyStatusQuo.total;
    const p10 = baseTotals.map(v => v * 0.9);
    const p90 = baseTotals.map(v => v * 1.1);
    const p25 = baseTotals.map(v => v * 0.95);
    const p75 = baseTotals.map(v => v * 1.05);

    const monteCtx = document.getElementById("monteCarlo");
    if (monteCtx) {
      new Chart(monteCtx, {
        type: "line",
        data: {
          labels: years,
          datasets: [
            {
              label: "P10–P90 Range",
              data: p90,
              borderWidth: 0,
              pointRadius: 0,
              fill: {
                target: 1,
                above: "rgba(56,189,248,0.06)",
                below: "rgba(56,189,248,0.06)"
              }
            },
            {
              label: "",
              data: p10,
              borderWidth: 0,
              pointRadius: 0
            },
            {
              label: "P25–P75 Range",
              data: p75,
              borderWidth: 0,
              pointRadius: 0,
              fill: {
                target: 3,
                above: "rgba(56,189,248,0.12)",
                below: "rgba(56,189,248,0.12)"
              }
            },
            {
              label: "",
              data: p25,
              borderWidth: 0,
              pointRadius: 0
            },
            {
              label: "Base IRP Trajectory",
              data: baseTotals,
              borderWidth: 2,
              pointRadius: 2
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          interaction: { mode: "index", intersect: false },
          plugins: {
            legend: {
              labels: { filter: item => item.text !== "" }
            },
            tooltip: {
              callbacks: {
                label: ctx =>
                  `${ctx.dataset.label || "Bound"}: ${ctx.parsed.y.toLocaleString(undefined, { maximumFractionDigits: 0 })} MW`
              }
            }
          },
          scales: {
            x: {
              grid: { color: "rgba(31,41,55,0.6)" }
            },
            y: {
              title: { display: true, text: "Total Capacity (MW)" },
              grid: { color: "rgba(31,41,55,0.6)" }
            }
          }
        }
      });
    }

    // ----- POLICY HEATMAP COLORING -----
    function scoreToColor(score) {
      // Map 1–5 to red → yellow → green
      const t = (score - 1) / 4; // 0..1
      const r = Math.round(185 * (1 - t) + 34 * t);  // 185 → 34
      const g = Math.round(28 * (1 - t) + 197 * t);  // 28 → 197
      const b = Math.round(28 * (1 - t) + 94 * t);   // 28 → 94
      return `rgb(${r}, ${g}, ${b})`;
    }

    document.querySelectorAll("td[data-score]").forEach(td => {
      const score = parseFloat(td.dataset.score);
      td.style.backgroundColor = scoreToColor(score);
      td.style.color = score >= 4 ? "#f9fafb" : "#0b1120";
    });
  </script>
</body>
</html>
